/*67c5abf83188bbd198a858c0acae492502cf1fde*/Ext.define("MyApp.view.Draw",{extend:"Ext.Container",config:{id:"Main",layout:{type:"card"},items:[{xtype:"panel",id:"MainView",layout:{align:"center",pack:"center",type:"vbox"},scrollable:false,items:[{xtype:"panel",flex:2,id:"TopView",style:"background-color: gray",width:"90%",layout:{type:"card"}},{xtype:"panel",flex:1,id:"BottomView",width:"90%",layout:{align:"center",pack:"center",type:"hbox"},items:[{xtype:"button",action:"Room",flex:1,height:"70%",id:"MakeRoom",margin:"10px",ui:"decline-round",text:"방만들기"},{xtype:"spacer",flex:0,width:10},{xtype:"button",action:"connection",flex:1,height:"70%",id:"Connect",margin:"10px",ui:"action-round",text:"참여하기"}]}]},{xtype:"panel",id:"CanvasView",layout:{type:"card",},items:[{xtype:"toolbar",docked:"top",height:40,id:"TopToolbar",ui:"neutral",title:"",layout:{align:"center",pack:"center",type:"hbox"},items:[{xtype:"button",height:"40px",id:"ToolPen",ui:"plain",width:"40px",icon:"",iconAlign:"center",iconMask:true},{xtype:"button",height:"40px",id:"ToolEraser",ui:"plain",width:"40px",iconAlign:"center",iconMask:true},{xtype:"button",id:"RoomNum",padding:"",ui:"plain",iconAlign:"center",iconMask:true,text:"102525"},{xtype:"button",height:"40px",id:"ToolNew",ui:"plain",width:"40px",iconAlign:"center",iconMask:true},{xtype:"button",height:"40px",id:"ToolSetting",ui:"plain",width:"40px",iconAlign:"center",iconMask:true}]},{xtype:"toolbar",docked:"bottom",height:40,id:"BottomToolbar",ui:"neutral",layout:{align:"center",pack:"center",type:"hbox"},items:[{xtype:"button",height:40,id:"ColorRed",ui:"plain",width:"40px",icon:"",iconAlign:"center",iconMask:true},{xtype:"button",height:"40px",id:"ColorBlue",ui:"plain",width:"40px",iconAlign:"center",iconMask:true},{xtype:"button",height:"40px",id:"ColorYellow",ui:"plain",width:"40px",iconAlign:"center",iconMask:true},{xtype:"button",id:"ColorGreen",minHeight:"40px",ui:"plain",width:"40px",iconAlign:"center",iconMask:true},{xtype:"button",height:"40px",id:"ColorBlack",ui:"plain",width:"40px",iconAlign:"center",iconMask:true},{xtype:"button",height:"40px",id:"ColorGray",ui:"plain",width:"40px",iconAlign:"center",iconMask:true}]},{xtype:"panel",html:'<canvas id="mycanvas" width="640" height="960" style="width:100%; height:100%;"></canvas>',id:"CanvasPanel",scope:"this",layout:{type:"card"},listeners:{painted:function(){var b=document.getElementById("mycanvas");var c=b.getContext("2d");var d=function(f,e){if(!isDraw){isDraw=true;if(e=="mouse"){oldPoint=Ext.create("Point",{x:f.offsetX,y:f.offsetY,width:lineWidth,color:strokeStyle,current_width:window.document.body.clientWidth,current_height:window.document.body.clientHeight-80})}else{if(e=="touch"){console.log(f.touches[0].pageX);console.log(f.pageX);oldPoint=Ext.create("Point",{x:f.pageX,y:f.pageY-40,width:lineWidth,color:strokeStyle,current_width:window.document.body.clientWidth,current_height:window.document.body.clientHeight})}}}};var a=function(f,e){if(isDraw){if(e=="mouse"){newPoint=Ext.create("Point",{x:f.offsetX,y:f.offsetY,width:lineWidth,color:strokeStyle,current_width:window.document.body.clientWidth,current_height:window.document.body.clientHeight-80})}else{if(e=="touch"){newPoint=Ext.create("Point",{x:f.pageX,y:f.pageY-40,width:lineWidth,color:strokeStyle,current_width:window.document.body.clientWidth,current_height:window.document.body.clientHeight})}}c.beginPath();c.moveTo(oldPoint.cx(),oldPoint.cy());c.lineTo(newPoint.cx(),newPoint.cy());c.stroke();oldPoint=newPoint}};b.addEventListener("mousedown",function(e){d(e,"mouse")});b.addEventListener("mousemove",function(e){a(e,"mouse")});b.addEventListener("mouseup",function(e){isDraw=false});b.addEventListener("touchstart",function(e){d(e,"touch")});b.addEventListener("touchmove",function(e){a(e,"touch")});b.addEventListener("touchend",function(e){isDraw=false})}}}]}]}});Ext.define("MyApp.controller.Canvas",{extend:"Ext.app.Controller",config:{refs:{toolPen:"#ToolPen",toolEraser:"#ToolEraser",roomNum:"#RoomNum",toolNew:"#ToolNew",toolSetting:"#ToolSetting",colorRed:"#ColorRed",colorBlue:"#ColorBlue",colorYellow:"#ColorYellow",colorGreen:"#ColorGreen",colorBlack:"#ColorBlack",colorGray:"#ColorGray",canvasView:"#CanvasView",topToolbar:"#TopToolbar",bottomToolbar:"#BottomToolbar"},control:{toolPen:{tap:"onButtonTap"}}},onButtonTap:function(b,c,a){}});Ext.define("MyApp.controller.Main",{extend:"Ext.app.Controller",config:{refs:{mainView:"#MainView",makeRoom:"#MakeRoom",connect:"#Connect",main:"#Main"},control:{"[action=Room]":{tap:"onButtonTapMakeRoom"},"[action=connection]":{tap:"onButtonTapConnect"}}},onButtonTapMakeRoom:function(b,c,a){console.log("button makeroom tap");this.getMain().animateActiveItem(1,{type:"reveal",direction:"up"})},onButtonTapConnect:function(b,c,a){console.log("button connect tap");Ext.Msg.show({title:"방번호를 입력하세요",msg:null,buttons:[{itemId:"ok",text:"참여하기",ui:"action"},{itemId:"cancle",text:"취소"}],prompt:{maxlength:6,autocapitalize:false},fn:function(e,d){console.log(e);console.log(d);if(e=="ok"){Ext.getCmp("RoomNum").setText(d);Ext.getCmp("Main").animateActiveItem(1,{type:"reveal",direction:"down"})}else{}}})}});var strokeStyle="black";var fillStyle="white";var lineWidth=1;var isDraw=false;var mode="pen";var newPoint,oldPoint;Ext.define("Point",{config:{x:null,y:null,width:null,color:null,standard_width:640,standard_height:960,current_width:null,current_height:null,},constructor:function(a){this.initConfig(a)},cx:function(){return((this._x*this._standard_width)/this._current_width)},cy:function(){return((this._y*this._standard_height)/this._current_height)}});Ext.Loader.setConfig({enabled:true});Ext.application({name:"MyApp",requires:["Ext.MessageBox"],views:["Draw"],controllers:["Canvas","Main"],icon:{"57":"resources/icons/Icon.png","72":"resources/icons/Icon~ipad.png","114":"resources/icons/Icon@2x.png","144":"resources/icons/Icon~ipad@2x.png"},isIconPrecomposed:true,startupImage:{"320x460":"resources/startup/320x460.jpg","640x920":"resources/startup/640x920.png","768x1004":"resources/startup/768x1004.png","748x1024":"resources/startup/748x1024.png","1536x2008":"resources/startup/1536x2008.png","1496x2048":"resources/startup/1496x2048.png"},launch:function(){Ext.fly("appLoadingIndicator").destroy();Ext.Viewport.add(Ext.create("MyApp.view.Draw",{fullscreen:true}))},onUpdated:function(){Ext.Msg.confirm("Application Update","This application has just successfully been updated to the latest version. Reload now?",function(a){if(a==="yes"){window.location.reload()}})}});